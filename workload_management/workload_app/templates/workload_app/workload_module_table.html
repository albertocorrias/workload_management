{% load static %}

<table id="TABLE_2" class="workload_tables table table-striped">
        <thead class="table-dark" id="workload_module_table_id">
        <tr> 
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th>Course Code</th>
            <th>Course Title</th>
            <th>Lecturers Assigned</th>
            <th>Total assigned hours</th>
            <th>Needed hours</th>
        </tr>
        </thead>
        <tbody>
            {% for entry in mod_table %}
            <tr>
                <td> <button type="button" class="btn btn-default" data-bs-toggle="modal" data-bs-target="#Module{{ entry.module_id }}DetailsModal">
                        <img src="{% static 'bootstrap-icons-1.5.0/pencil-square.svg' %}" alt="edit"> </button>
                </td>
                <td><button type="button" class="btn btn-default" data-bs-toggle="modal" data-bs-target="#Module{{ entry.module_id }}AddAssignmentForModuleModal">            
                        <img src="{% static 'workload_app/plus-square-green.svg' %}" alt="edit">
                </td>
                <td><a href="/workload_app/module/{{ entry.module_code }}">{{ entry.module_code }}</a></td><!-- Mod code-->
                <td title = "{{ entry.module_full_title }}">{{ entry.module_title }}</td><!-- Mod title-->
                <td>{{ entry.module_lecturers }} <div class="not_counted_assignments">{{ entry.module_lecturers_not_counted }}</div><!--teaching assignments for this module--></td>
                <td>{{ entry.module_assigned_hours|floatformat }}</td><!-- Total hours assigned-->
                <td>{{ entry.module_hours_needed|floatformat }}</td><!-- Hours needed as per module characteristics-->
            </tr>
            {% endfor %}
        </tbody>
</table>   



{% for entry in mod_table %}
<!-- Edit module's details modal -->
<div class="modal fade" id="Module{{ entry.module_id }}DetailsModal" tabindex="-1" role="dialog" aria-labelledby="Module{{ entry.module_id }}DetailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="Module{{ entry.module_id }}DetailsModalLabel">Edit details for {{ entry.module_code }}</h5>
            	<button type="button" class="btn btn-default" data-bs-dismiss="modal" aria-label="Close">
              		<img src="{% static 'workload_app/x-square-red.svg' %}" alt="close">
		        </button>
		      </div>
		     <form action="{% url 'workload_app:add_module' workloadscenario_id %}" method="post">
		     {% csrf_token %}
		            <div class="modal-body">                
		                {{ entry.mod_form.as_p }}
		             </div>
		              <div class="modal-footer">
		                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel and Close</button>
		                <button type="submit" class="btn btn-primary">Save changes</button>
		              </div>
		        
		    </form>
			    
		    {% if  entry.num_assigns_for_module > 0 %}
		    <div class="modal-header">
		           <h5 class="modal-title" id="{{ entry.module_id }}ManageModuleAssignmentModalLabel">Edit assignments for {{ entry.module_code }}</h5>
		    </div>
		     <form action="{% url 'workload_app:edit_module_assignments' entry.module_id %}" method="post">
		     {% csrf_token %}
		            <div class="modal-body">
                  {% for field in entry.edit_module_assign_form %}
					{% if field.is_hidden %}
				  		{% if "never_display" in field.label %}
				  			<p></p>
						{% else %}
				  			<p class="header_of_edit_form">{{ field.label }}</p>
						{% endif %}
                    {% else %}
					<p><div style="display:inline;">{{ field.label }} {{ field }}</div></p>
                    {% endif %}
                  {% endfor %}
		              </div>
		              <div class="modal-footer">
		                <p>Note: if you indicate 0 hours, the lecturer will be removed from those teaching {{ entry.module_code }}</p>
		                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel and Close</button>
		                <button type="submit" class="btn btn-primary">Save changes</button>
		              </div>
		        
		    </form>
		  {% endif %}
        </div>
     </div>
</div>
  
 <!-- Add assignment modal for specific module-->
<div class="modal fade" id="Module{{ entry.module_id }}AddAssignmentForModuleModal" tabindex="-1" role="dialog" aria-labelledby="Module{{ entry.module_id }}AddAssignmentForModuleModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
	  <div class="modal-content">
	    <div class="modal-header">
	      <h5 class="modal-title" id="Module{{ entry.module_id }}AddAssignmentForModuleModal">Add assignment for {{ entry.module_code }}</h5>
            <button type="button" class="btn btn-default" data-bs-dismiss="modal" aria-label="Close">
              <img src="{% static 'workload_app/x-square-red.svg' %}" alt="close">
            </button>
	    </div>
	   <form action="{% url 'workload_app:add_assignment' workloadscenario_id %}" method="post">
	   {% csrf_token %}
	        <div class="modal-body">
	              {{ entry.add_assignment_for_mod_form.as_p }}
	        </div>
	        <div class="modal-footer">
	          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel and Close</button>
	          <button type="submit" class="btn btn-primary">Save changes</button>
	        </div>
	  </form>
	  </div><!--modal content-->
	</div><!--modal dialogue-->
</div><!--Whole modal-->
	 
{% endfor %}